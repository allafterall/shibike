---
import { Image } from "astro:assets";
import Heading from "./Heading.astro";
import GoogleMapEmbed from "./GoogleMapsEmbed.astro";

interface TestimonialItem {
  quote: string;
  author: string;
  link?: string;
  image?: ImageMetadata; // Or string if you prefer direct paths and not using Astro's Image optimization
  imageAlt?: string;
}

interface Props {
  title: string;
  items: TestimonialItem[];
}

const { title, items } = Astro.props;

// Replace this with your actual Google Maps embed URL
const googleMapsEmbedUrl = "https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d39717.67735579412!2d-0.16587221557771906!3d51.52505133729184!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x222d7c4f2ec9d22d%3A0x6677353ef1e0b237!2sShiBike!5e0!3m2!1sen!2suk!4v1748450785298!5m2!1sen!2suk";
const googleMapsLink = "https://maps.app.goo.gl/qT1sbBE8UAfa67BC9"; 
---

<div class="flex flex-col items-center text-center gap-8">
  <Heading level="h2">{title}</Heading>
  <div class="grid md:grid-cols-2 gap-8 max-w-4xl mx-auto">
    {
      items.map((item) => {
        const commonClasses =
          "p-6 bg-shiba-brown-dark rounded-lg shadow-md text-left flex flex-col";
        const testimonialContent = (
          <>
            {item.image && (
              <div class="flex justify-center mb-4">
                <Image
                  src={item.image}
                  alt={item.imageAlt || `Photo of ${item.author}`}
                  class="w-20 h-20 rounded-full object-cover border-2 border-shiba-brown-light"
                  width={80}
                  height={80}
                />
              </div>
            )}
            <p class="text-lg italic font-serif text-background">
              "{item.quote}"
            </p>
            <footer class="mt-4 text-sm text-background/80 text-right">
              - {item.author}
            </footer>
          </>
        );

        return item.link ? (
          <a
            href={item.link}
            target="_blank"
            rel="noopener noreferrer"
            class={`${commonClasses} hover:bg-shiba-brown-dark/80 transition-colors`}
          >{testimonialContent}</a>
        ) : (
          <blockquote class={commonClasses}>{testimonialContent}</blockquote>
        );
      })
    }
  </div>
  <div class="mt-12 w-full max-w-4xl mx-auto">
    <Heading level="h3" class="mb-4">Area of Operations</Heading>
    <p class="mb-6 text-text/80">
      I operate across Central London. You can also find more reviews on <a href={googleMapsLink} target="_blank" rel="noopener noreferrer" class="text-primary hover:underline font-semibold">Google Maps</a>.
    </p>
    <div class="rounded-lg shadow-lg overflow-hidden border border-shiba-brown-light/20">
      <GoogleMapEmbed
        embedUrl={googleMapsEmbedUrl}
        title="ShiBike Service Area - Central London"
        height="400px"
      />
    </div>
  </div>
</div>